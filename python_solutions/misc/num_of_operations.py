from copy import copy
from typing import List
from collections import defaultdict

class Solution:

    @staticmethod
    def _yieldActiveConnectionList(_connections, node, nodeset=None):

        if not nodeset:
            nodeset = set()

        if node in nodeset:
            return None

        else:
            nodeset.add(node)
            for connection in _connections[node]:
                res = Solution._yieldActiveConnectionList(_connections, connection, nodeset)
                if res and res not in nodeset:
                    nodeset.update(res)
        return nodeset




    def makeConnected(self, n: int, connections: List[List[int]]) -> int:

        if len(connections) < n-1:
            return -1  # not enough cables to construct a connected mesh

        _connections = defaultdict(list)

        for connection in connections:
            _connections[connection[0]].append(connection[1])
            _connections[connection[1]].append(connection[0])


        extra_connection_counter = 0

        nodeset = Solution._yieldActiveConnectionList(_connections, next(iter(_connections)))
        if len(nodeset) == n:
            return 0

        isolatedIndex = None
        for i in range(n):
            if i not in nodeset:
                isolatedIndex = i
                break

        while len(nodeset)<n:
            #print("connectivity level: %s" % len(nodeset))


            for i in range(isolatedIndex, n):
                if i not in nodeset:
                    isolatedIndex = i
                    break


            # skip breaking cable, as it doesn't matter

            # connect missing node to network
            extra_connection_counter += 1
            connectionPoint = next(iter(_connections))
            _connections[isolatedIndex].append(connectionPoint)
            _connections[connectionPoint].append(isolatedIndex)
            nodeset = Solution._yieldActiveConnectionList(_connections, isolatedIndex, nodeset)
        return extra_connection_counter
            #
            #
            # # detect extra connection
            # for k, v in _connections.items():
            #     if len(v) > 1:
            #         for _connection in v:
            #             if len(_connections[_connection]) > 1:
            #                 # found the connection. try to break and see how connectivity gets affected
            #                 _connections[_connection].remove(k)
            #                 _connections[k].remove(_connection)
            #                 revised_connectivity = Solution._yieldActiveConnectionList(_connections, next(iter(_connections)))
            #                 if nodeset == revised_connectivity:
            #                     extra_connection_counter += 1
            #                     connectionPoint = next(iter(_connections))
            #                     _connections[isolatedIndex].append(connectionPoint)
            #                     _connections[connectionPoint].append(isolatedIndex)
            #                     break
            #                 else:
            #                     #print("revised connectivity reduced! from %s to %s" % (len(nodeset), len(revised_connectivity)))
            #                     # revert changes and look for another cable to break
            #                     _connections[_connection].append(k)
            #                     _connections[k].append(_connection)
            #         else:
            #             continue
            #         break
            # else:
            #     return -1






def verbose_assert(*args):
    output = Solution().makeConnected(*args)
    print("Input:  %s\nOutput: %s" % (args, output))


if __name__ == '__main__':
    # a = defaultdict(list)
    # a[0].extend([1,2])
    # a[1].extend([0,2])
    # a[2].extend([0,1])
    # result = Solution.yieldMissingConnection(n, a)
    # print("n:%s, a:%s, missingConn:%s" % (n, a, next(result)))

    # n = 4
    # connections = [[0,1],[0,2],[1,2]]
    n = 1000
    connections = [[619,737],[241,660],[177,579],[26,69],[799,850],[286,551],[319,333],[425,837],[612,652],[395,714],[366,490],[195,981],[223,504],[644,965],[704,915],[43,307],[628,926],[393,593],[726,797],[135,142],[308,577],[58,917],[140,633],[572,816],[837,917],[616,910],[687,690],[438,716],[253,309],[365,536],[289,837],[335,559],[190,416],[98,132],[654,781],[399,822],[144,737],[491,769],[150,780],[162,530],[371,939],[311,987],[321,336],[400,488],[191,244],[551,760],[419,900],[181,937],[334,558],[138,903],[429,964],[39,864],[476,687],[155,777],[265,672],[864,877],[246,855],[266,342],[47,65],[482,642],[11,812],[670,913],[395,701],[449,481],[542,603],[203,751],[112,510],[8,118],[548,611],[518,887],[514,927],[547,919],[142,313],[116,343],[469,700],[387,921],[473,535],[264,475],[217,471],[422,867],[236,649],[155,221],[586,901],[139,690],[149,221],[243,876],[442,777],[100,397],[682,853],[24,389],[381,702],[388,741],[182,237],[200,270],[644,741],[60,782],[455,485],[93,792],[120,729],[286,412],[91,246],[624,960],[56,992],[165,281],[117,571],[432,531],[160,937],[52,852],[377,976],[20,186],[632,881],[721,753],[216,568],[119,155],[343,812],[566,721],[191,545],[10,338],[460,485],[313,323],[277,714],[556,740],[716,818],[140,694],[243,554],[268,411],[25,85],[740,742],[267,934],[161,430],[600,699],[32,460],[653,979],[511,604],[45,861],[315,466],[255,491],[802,918],[768,866],[422,447],[138,461],[768,923],[543,804],[533,619],[483,517],[459,641],[168,208],[224,541],[40,348],[645,981],[846,884],[35,828],[139,918],[732,835],[165,708],[655,857],[275,498],[784,860],[96,540],[461,586],[471,661],[752,893],[13,687],[93,900],[150,553],[169,654],[26,802],[348,550],[339,994],[10,822],[463,944],[81,961],[576,578],[370,896],[519,913],[177,704],[505,604],[677,687],[338,724],[112,884],[573,635],[37,282],[298,602],[118,552],[170,993],[126,967],[734,745],[717,869],[385,487],[245,687],[127,648],[254,691],[807,859],[796,958],[466,687],[124,126],[348,976],[36,682],[479,613],[58,934],[193,872],[630,793],[275,348],[233,889],[8,637],[454,725],[414,816],[70,328],[737,834],[439,975],[173,634],[170,515],[659,675],[746,858],[813,943],[740,747],[279,750],[361,635],[134,170],[592,917],[38,468],[354,619],[542,883],[63,735],[189,803],[126,241],[611,666],[755,939],[8,277],[157,418],[118,868],[255,859],[162,792],[72,919],[105,934],[164,434],[474,970],[284,764],[414,833],[807,824],[587,695],[605,873],[44,647],[315,608],[675,982],[760,767],[432,949],[295,710],[113,587],[366,822],[342,751],[158,962],[276,635],[63,734],[21,851],[502,902],[406,703],[356,679],[508,665],[93,363],[438,537],[68,550],[752,774],[187,966],[826,912],[805,809],[515,841],[148,638],[481,697],[24,138],[407,978],[138,324],[129,772],[297,892],[310,959],[257,481],[28,634],[478,614],[106,985],[183,992],[696,841],[598,963],[374,791],[19,549],[540,644],[678,906],[282,435],[268,561],[8,267],[680,817],[538,543],[839,859],[540,701],[146,489],[186,847],[190,707],[169,462],[726,999],[389,601],[18,847],[475,482],[118,499],[56,481],[447,796],[345,882],[11,245],[648,711],[20,235],[113,425],[140,836],[154,191],[161,218],[264,504],[173,692],[659,880],[652,724],[191,713],[333,446],[533,596],[482,608],[85,291],[404,454],[325,530],[837,875],[195,267],[72,618],[17,819],[224,425],[246,601],[174,366],[274,340],[589,831],[803,963],[86,658],[367,885],[410,474],[69,388],[181,530],[573,646],[326,728],[128,883],[35,702],[107,992],[147,238],[363,449],[454,634],[32,169],[563,581],[589,605],[29,978],[877,942],[608,895],[38,296],[78,848],[865,930],[610,754],[781,836],[398,503],[227,865],[853,867],[70,167],[244,250],[566,643],[743,856],[197,671],[498,672],[287,870],[503,669],[441,846],[165,231],[402,855],[281,407],[195,931],[398,809],[410,483],[652,935],[277,631],[275,673],[467,828],[204,635],[94,831],[246,381],[535,978],[35,538],[177,820],[88,285],[144,760],[243,930],[225,651],[139,705],[176,866],[190,203],[13,270],[243,669],[766,974],[127,610],[140,145],[90,347],[951,991],[14,280],[705,765],[686,884],[163,435],[60,776],[754,838],[345,351],[186,481],[494,674],[112,742],[303,876],[639,789],[708,959],[803,815],[358,521],[614,895],[36,175],[641,909],[754,937],[178,792],[130,781],[91,510],[822,911],[449,841],[29,482],[528,690],[24,558],[448,620],[205,765],[505,950],[222,635],[35,473],[295,855],[359,978],[136,706],[32,700],[478,642],[403,467],[141,617],[217,260],[190,193],[817,926],[74,740],[436,847],[865,875],[75,200],[637,782],[419,912],[348,365],[235,620],[130,592],[580,845],[270,908],[426,604],[617,658],[262,774],[579,802],[16,726],[946,995],[890,964],[369,532],[202,815],[371,848],[146,390],[23,756],[494,570],[309,565],[683,955],[451,990],[741,881],[4,801],[28,226],[115,425],[65,380],[302,615],[304,944],[402,513],[541,909],[138,445],[236,311],[616,744],[330,336],[562,906],[246,646],[549,887],[37,159],[141,731],[260,599],[377,957],[42,981],[324,558],[205,682],[88,459],[432,565],[741,913],[306,357],[178,629],[403,487],[276,290],[179,335],[127,280],[62,872],[161,785],[32,738],[111,442],[147,994],[855,929],[53,786],[128,821],[454,785],[29,721],[465,934],[15,222],[611,640],[250,536],[9,491],[236,769],[124,205],[252,387],[469,777],[308,916],[302,878],[467,672],[443,483],[180,314],[177,812],[213,644],[73,483],[761,831],[590,615],[757,846],[276,491],[514,947],[138,310],[241,899],[358,983],[556,657],[587,775],[780,820],[538,600],[72,124],[262,642],[53,394],[460,714],[51,456],[593,847],[240,518],[358,801],[425,498],[291,408],[85,907],[748,755],[121,653],[335,785],[312,932],[496,896],[130,320],[6,323],[612,617],[472,581],[11,161],[34,970],[558,971],[342,806],[369,905],[162,170],[977,996],[674,728],[445,787],[623,668],[19,75],[812,886],[360,765],[569,764],[472,960],[50,611],[168,716],[444,954],[507,862],[182,615],[847,922],[23,682],[429,687],[409,734],[368,494],[687,931],[545,859],[141,238],[26,694],[34,311],[104,454],[853,944],[139,567],[620,828],[494,798],[463,485],[61,823],[44,349],[641,891],[467,932],[359,786],[209,368],[514,876],[568,610],[592,672],[268,786],[157,502],[742,836],[210,931],[231,420],[170,737],[48,150],[35,586],[73,238],[378,715],[412,925],[414,880],[329,565],[264,872],[95,441],[460,790],[199,872],[68,182],[4,183],[135,685],[300,571],[560,998],[156,427],[190,612],[99,274],[303,937],[234,562],[28,485],[506,572],[364,533],[180,682],[0,630],[467,658],[270,650],[168,409],[53,624],[484,708],[619,763],[715,805],[315,837],[186,614],[249,765],[132,623],[217,813],[453,792],[295,732],[699,777],[608,828],[361,586],[71,258],[639,808],[201,557],[169,886],[9,635],[357,599],[610,947],[330,503],[800,970],[518,808],[176,663],[127,580],[22,629],[510,876],[8,42],[189,506],[362,708],[343,666],[198,475],[532,969],[214,434],[293,937],[261,517],[571,699],[51,79],[677,859],[203,923],[200,698],[235,948],[238,969],[96,273],[462,640],[80,577],[292,500],[194,409],[600,638],[90,509],[724,978],[204,224],[519,928],[794,980],[909,959],[138,747],[536,582],[99,182],[195,703],[349,690],[7,138],[811,934],[458,585],[789,847],[436,981],[8,165],[83,716],[280,821],[843,960],[731,971],[115,262],[346,349],[273,921],[386,695],[175,748],[579,993],[434,685],[275,370],[66,310],[238,605],[305,620],[22,895],[682,805],[508,782],[83,501],[175,655],[603,981],[455,493],[549,800],[649,982],[86,96],[312,495],[136,475],[471,942],[50,565],[6,851],[582,699],[164,837],[306,494],[184,893],[555,795],[354,620],[145,217],[328,935],[781,936],[3,984],[15,237],[478,830],[130,497],[254,782],[281,356],[24,526],[656,961],[598,930],[306,612],[524,947],[684,737],[384,990],[35,172],[78,418],[401,848],[208,771],[101,491],[371,948],[321,330],[18,840],[570,588],[807,833],[242,276],[359,979],[391,624],[271,763],[192,432],[187,883],[269,865],[259,797],[97,786],[94,479],[38,145],[314,519],[85,365],[503,843],[748,795],[178,896],[115,684],[837,904],[747,786],[525,925],[329,672],[83,316],[793,941],[0,206],[365,871],[951,968],[116,369],[107,558],[305,677],[344,780],[144,954],[117,880],[362,844],[40,322],[132,442],[209,468],[66,173],[690,723],[172,881],[769,909],[37,467],[61,657],[166,905],[135,448],[396,643],[133,785],[44,594],[109,470],[189,672],[260,469],[755,769],[144,704],[159,901],[340,356],[285,898],[98,235],[785,922],[431,741],[43,870],[769,976],[4,430],[690,904],[518,534],[163,242],[291,865],[637,716],[860,901],[605,940],[408,702],[379,448],[477,666],[389,590],[480,845],[154,180],[508,512],[512,813],[18,97],[304,712],[539,747],[513,657],[363,467],[435,994],[74,331],[153,489],[46,506],[367,403],[701,743],[181,541],[46,831],[671,811],[37,718],[85,945],[500,851],[154,230],[796,829],[116,365],[196,946],[140,463],[327,834],[367,879],[456,765],[487,901],[621,998],[204,337],[564,620],[535,643],[187,382],[380,453],[227,716],[603,648],[255,534],[7,252],[173,958],[386,951],[674,805],[411,840],[502,622],[475,721],[325,449],[90,676],[40,707],[364,724],[166,847],[635,770],[92,250],[76,372],[140,303],[313,561],[361,864],[803,870],[407,737],[46,184],[772,918],[6,388],[198,880],[364,683],[516,746],[142,318],[528,779],[25,667],[598,923],[180,995],[428,978],[540,617],[58,448],[222,865],[106,306],[18,102],[235,927],[7,515],[470,745],[280,575],[282,363],[234,572],[306,543],[719,836],[21,505],[331,930],[816,875],[240,267],[24,126],[2,314],[464,976],[670,721],[680,833],[443,809],[379,810],[691,701],[551,735],[448,935],[185,194],[510,753],[586,899],[203,337],[707,804],[866,922],[239,871],[166,683],[566,718],[164,562],[322,697],[110,648],[185,446],[459,918],[151,894],[6,990],[731,952],[23,358],[159,389],[131,711],[479,489],[245,842],[48,172],[120,437],[527,910],[145,406],[196,811],[248,722],[165,233],[67,585],[12,374],[669,801],[101,520],[69,459],[467,735],[708,975],[18,871],[574,683],[897,967],[221,935],[77,752],[77,769],[736,975],[658,674],[77,469],[441,446],[584,938],[776,903],[186,975],[129,501],[161,436],[281,814],[63,730],[30,660],[724,832],[64,608],[25,395],[88,810],[74,978],[486,780],[741,986],[429,857],[576,900],[195,534],[32,641],[21,833],[788,814],[100,875],[114,242],[382,718],[768,800],[432,621],[552,984],[574,977],[6,410],[254,390],[175,194],[189,810],[647,689],[139,193],[214,707],[160,443],[731,983],[159,453],[193,586],[251,778],[52,695],[601,725],[206,890],[557,701],[227,445],[484,912],[225,504],[540,833],[248,352],[823,908],[807,870],[433,747],[323,441],[195,615],[714,825],[639,651],[66,280],[287,822],[495,916],[633,986],[0,682],[492,718],[859,892],[763,973],[33,340],[635,907],[162,843],[79,282],[282,731],[380,690],[609,911],[318,600],[275,487],[41,746],[184,879],[877,949],[719,721],[150,270],[256,957],[272,511],[573,725],[36,283],[370,671],[260,272],[537,981],[673,784],[334,663],[24,289],[498,500],[897,980],[422,838],[490,610],[729,966],[400,595],[233,963],[5,787],[240,929],[478,799],[41,527],[454,704],[116,979],[142,812],[142,277],[404,754],[591,747],[89,837],[679,739],[439,823],[326,743],[459,948],[371,608],[128,345],[540,741],[52,928],[91,566],[523,957],[215,353],[242,466],[794,978],[473,919],[207,911],[132,581],[635,697],[496,771],[74,569],[96,984],[147,743],[19,188],[182,453],[533,573],[304,647],[75,695],[345,603],[400,966],[188,746],[781,902],[29,410],[607,783],[131,941],[75,363],[842,868],[709,955],[36,987],[572,842],[679,746],[493,669],[213,442],[464,982],[76,389],[88,732],[31,842],[507,606],[732,828],[225,415],[422,718],[92,485],[90,649],[330,633],[641,836],[262,613],[168,456],[44,261],[76,695],[667,712],[203,724],[72,687],[156,175],[21,431],[717,818],[668,857],[359,693],[11,95],[238,887],[25,191],[242,582],[198,271],[162,754],[187,415],[783,988],[751,774],[928,975],[194,224],[216,804],[95,679],[411,898],[837,838],[237,615],[310,599],[446,495],[725,753],[47,397],[383,860],[833,927],[435,692],[460,672],[178,714],[27,715],[136,795],[355,555],[66,906],[216,743],[146,237],[357,421],[768,824],[201,347],[223,700],[775,868],[481,501],[508,677],[184,321],[110,935],[335,855],[398,810],[170,209],[168,623],[178,302],[358,768]]
    args = (n, connections)
    verbose_assert(*args)
